### Описание
Плейбуки, предназначенные для конфигурирования staging и production серверов.
Ссылки на источники ролей:
https://robertdebock.nl/ \
https://robertdebock.nl/how-to-use-these-roles.html \
https://github.com/geerlingguy/ansible-role-security


### Пердварительные соглашения:
1. Каталог `ansible/online2` является единственным корневым каталогом для запуска контейнера с ansible.
2. Порядок запуска плейбуков определяется файлами скриптов `play-step-XXX.sh`.
3. Все скрипты запуска плейбуков `play-step-XXX.sh` должны лежать и запускаться в корне `ansible/online2`.
4. Все плейбуки кроме `prerequisites.yml` должны использовать ssh-key, а не логин и пароль.
5. При штатном окончании скрипт `play-step-001.sh` нормально отработает только при первом запуске т.к. этот плейбук рубит доступ по логину и паролю.
6. Контейнер с ansible создает ssh-ключи в хостовой системе с правами только у root'а. Поэтому для переноса каталога с репо и ключами нужно выполнять копирование через sudo.
7. Предполагается, что на вход поступает VM, у которой разрешен логин root'а по ssh и известен пароль root'а (по окончанию выполнения плейбуков root-доступ будет отключен).
8. Последующий доступ к VM по ssh (нужно помнить о правах на ключи, которые ожидает ssh-клиент: 700 на каталого и 600 на закрытый ключ):
```shell script
cd online2/
# подставить соответствующие значения из файлов hosts.yml и vars.yml
sudo ssh -i ./ssh_keys/[admin_user_name] [admin_user_name]@[ansible_host]
```

### Запуск playbooks:
Создайте каталог "inventories". Отредактируйте копию файла `templates/hosts.default.yml`, переименуйте в `hosts.yml` и поместите в каталог `inventories`.
Создайте каталог "inventories/group_vars". Отредактируйте копию файла `templates/vars.default.yml.yml`, переименуйте в `vars.yml` и поместите в каталог `inventories/group_vars`. 
Должна получиться след. структура:
```text
├── inventories
│   ├── group_vars
│   │   └── vars.yml
│   └── hosts.yml
```
Каталоги inventories и ssh-keys добавлены в `.gitignore`, чтобы в репозитории не хранились уникальные для каждого хоста данные и логины с паролями. 
Все ansible variables нужно определять в плейбуках. Перед использованием репозитория нужно подготовить файл инвентаря. 
При запуске playbook'а есть возможность указать пользователя и пароль в файле `vars.yml` (если пользователя не существует, он будет создан, далее все действия будут выполняться от его имени). 
Пример запуска playbook:
```shell script
cd online2/
# если нужно, сделать скрипт исполняемым
chmod +x ./play-step-001.sh 
./play-step-001.sh
```
